<!--
@license
Copyright (c) 2015 
-->
<link rel="import" href="../polymer/polymer.html">

<!--
Behaviors with a set of filters to use with Polymer 1.0 <dom-repeat>.

Example:

    <template is="dom-repeat" items="{{ myItems }}" filter="{{ applyFilters(filterConfig) }}" sort="{{ applySorts(sortConfig) }}">
      <li><span>{{ item }}</span></li>
    </template> 

@demo
-->
<script>
  'use strict';
  /** @polymerBehavior */
  var PinHoleBehavior = {

    properties: {
      similarTo: {
        type: Object,
        value: {
          text: '',
          target: '',
        }
      },
      limitTo: {
        type: String,
        value: ''
      },
      limitFrom: {
        type: String,
        value: ''
      },
      filterConfig: {
        type: Object
      },    
    },

    observers: [
      'bindFilterConfig(similarTo.text, similarTo.target, limitTo, limitFrom)'
    ],

    // Element Behavior
    
    /**
     * Default filter names.
     * Override observers if you want to use another property names
     */
    bindFilterConfig: function() {
      console.log(this.filterConfig)
      this.filterConfig = {
        'similarTo': this.similarTo,
        'limitTo': this.limitTo,
        'limitFrom': this.limitFrom       
      }
    },

    // TODO
    applyFilters: function() {

    },

    /**
     * Applys a selected filter with its params
     * @return {Object} An array element or a function
     */
    applyFilter: function(){
     return this.filters[arguments[0]].apply(this, Array.prototype.slice.call(arguments, 1));
    },


    /**
     * A set of filters
     * @type {Object}
     */
    filters: {
      limitTo: function(data, limit, filter) {
        this.filters.counter = 0;
        return this.filters._limitTo.bind(this, data, limit, filter);
      },
      _limitTo: function(data, limit, filter) {
        this.filters.counter += 1;

        if (limit && this.filters.counter > limit) {
          return false;
        }

        return filter || true;
      },
    }


  };
    

</script>
